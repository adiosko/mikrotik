<html>
<head>
<title>Email.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #606366; font-weight: normal; font-style: normal; }
.s0 { color: rgb(204,120,50); }
.s1 { color: rgb(169,183,198); }
.s2 { color: rgb(104,151,187); }
.s3 { color: rgb(98,151,85); font-style: italic; }
.s4 { color: rgb(106,135,89); }
</style>
</head>
<BODY BGCOLOR="#2b2b2b">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
Email.py</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">from </span><span class="s1">tikapy </span><span class="s0">import </span><span class="s1">TikapyClient 
</span><span class="s0">from </span><span class="s1">tikapy </span><span class="s0">import </span><span class="s1">TikapySslClient 
 
</span><span class="s0">class </span><span class="s1">Email: 
    </span><span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">,</span><span class="s1">address</span><span class="s0">,</span><span class="s1">username</span><span class="s0">,</span><span class="s1">password): 
        self.client = TikapyClient( address</span><span class="s0">, </span><span class="s2">8728 </span><span class="s1">) 
        self.client.login( username</span><span class="s0">,</span><span class="s1">password) 
 
    </span><span class="s0">def </span><span class="s1">listEmaoilSettings(self): 
        </span><span class="s3">&quot;&quot;&quot; 
        Method will list email settings 
        :return: list 
        &quot;&quot;&quot;</span><span class="s1"> 
        mail = self.client.talk([</span><span class="s4">'/tool/e-mail/print'</span><span class="s1">]) 
        </span><span class="s0">if </span><span class="s1">mail == {}: 
            print(</span><span class="s4">&quot;No settings found&quot;</span><span class="s1">) 
        </span><span class="s0">else</span><span class="s1">: 
            </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">mail: 
                print(mail) 
        </span><span class="s0">return </span><span class="s1">mail 
    </span><span class="s0">def </span><span class="s1">setEmails(self</span><span class="s0">,</span><span class="s1">server</span><span class="s0">,</span><span class="s1">port</span><span class="s0">,</span><span class="s1">tls</span><span class="s0">,</span><span class="s1">fromMail</span><span class="s0">,</span><span class="s1">user</span><span class="s0">,</span><span class="s1">password): 
        </span><span class="s3">&quot;&quot;&quot; 
        Method will set mail server 
        :param server: IP where to send mail 
        :param port: standard 25, or custom port 
        :param tls: no (default)/ tls-only/yes 
        :param fromMail: mail 
        :param user: username 
        :param password:password 
        :return:list 
        &quot;&quot;&quot;</span><span class="s1"> 
        mail = self.client.talk([</span><span class="s4">'/tool/e-mail/set'</span><span class="s0">,</span><span class="s4">'=address='</span><span class="s1">+server</span><span class="s0">,</span><span class="s4">'=port='</span><span class="s1">+port</span><span class="s0">,</span><span class="s4">'=start-tls='</span><span class="s1">+tls</span><span class="s0">,</span><span class="s1"> 
                                 </span><span class="s4">'=from='</span><span class="s1">+fromMail</span><span class="s0">,</span><span class="s4">'=user='</span><span class="s1">+user</span><span class="s0">,</span><span class="s4">'=password='</span><span class="s1">+password]) 
        </span><span class="s0">return </span><span class="s1">mail 
 
    </span><span class="s0">def </span><span class="s1">sendEmail(self</span><span class="s0">,</span><span class="s1">address</span><span class="s0">,</span><span class="s1">port</span><span class="s0">,</span><span class="s1">user</span><span class="s0">,</span><span class="s1">password</span><span class="s0">,</span><span class="s1">tls</span><span class="s0">,</span><span class="s1">sendTo</span><span class="s0">,</span><span class="s1">fromUser</span><span class="s0">,</span><span class="s1">Subject</span><span class="s0">,</span><span class="s1">body</span><span class="s0">,</span><span class="s1">file=</span><span class="s0">None,</span><span class="s1">copy=</span><span class="s0">None</span><span class="s1">): 
        </span><span class="s3">&quot;&quot;&quot; 
        Method will send mail 
        :param address: SMTP address 
        :param port: 25 
        :param user: username 
        :param password: password 
        :param tls: use tls yes/no/tls-only 
        :param sendTo:mail to send 
        :param copy: mail(m\optional) 
        :param fromUser: source mail 
        :param Subject: mail subject 
        :param body: body of mail 
        :param file:  file (optional) 
        :return: 
        &quot;&quot;&quot;</span><span class="s1"> 
        </span><span class="s0">if </span><span class="s1">(file == </span><span class="s0">None</span><span class="s1">) </span><span class="s0">or </span><span class="s1">(copy == </span><span class="s0">None</span><span class="s1">): 
            mail = self.client.talk([</span><span class="s4">'/tool/e-mail/send'</span><span class="s0">,</span><span class="s4">'=server='</span><span class="s1">+address</span><span class="s0">,</span><span class="s4">'=port='</span><span class="s1">+port</span><span class="s0">,</span><span class="s4">'=user='</span><span class="s1">+user</span><span class="s0">,</span><span class="s1"> 
                                     </span><span class="s4">'=password='</span><span class="s1">+password</span><span class="s0">,</span><span class="s4">'=start-tls='</span><span class="s1">+tls</span><span class="s0">,</span><span class="s4">'=to='</span><span class="s1">+sendTo</span><span class="s0">,</span><span class="s4">'=from='</span><span class="s1">+fromUser</span><span class="s0">,</span><span class="s1"> 
                                     </span><span class="s4">'=subject='</span><span class="s1">+Subject</span><span class="s0">,</span><span class="s4">'=body='</span><span class="s1">+body]) 
        </span><span class="s0">else</span><span class="s1">: 
            mail = self.client.talk( [</span><span class="s4">'/tool/e-mail/send'</span><span class="s0">, </span><span class="s4">'=server=' </span><span class="s1">+ address</span><span class="s0">, </span><span class="s4">'=port='</span><span class="s1">+port</span><span class="s0">, </span><span class="s4">'=user=' </span><span class="s1">+ user</span><span class="s0">,</span><span class="s1"> 
                                      </span><span class="s4">'=password=' </span><span class="s1">+ password</span><span class="s0">, </span><span class="s4">'=start-tls='</span><span class="s1">+ tls</span><span class="s0">, </span><span class="s4">'=to='</span><span class="s1">+ sendTo</span><span class="s0">,</span><span class="s1"> 
                                      </span><span class="s4">'=from=' </span><span class="s1">+ fromUser</span><span class="s0">,</span><span class="s4">'=subject=' </span><span class="s1">+ Subject</span><span class="s0">, </span><span class="s4">'=body=' </span><span class="s1">+ body</span><span class="s0">,</span><span class="s4">'=file='</span><span class="s1">+file</span><span class="s0">,</span><span class="s1"> 
                                      </span><span class="s4">'=cc='</span><span class="s1">+copy]) 
        </span><span class="s0">return </span><span class="s1">mail</span></pre>
</body>
</html>