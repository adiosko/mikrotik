<html>
<head>
<title>deprecation.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #606366; font-weight: normal; font-style: normal; }
.s0 { color: rgb(98,151,85); font-style: italic; }
.s1 { color: rgb(169,183,198); }
.s2 { color: rgb(204,120,50); }
.s3 { color: rgb(128,128,128); }
.s4 { color: rgb(106,135,89); }
</style>
</head>
<BODY BGCOLOR="#2b2b2b">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
deprecation.py</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">&quot;&quot;&quot; 
A module that implements tooling to enable easy warnings about deprecations. 
&quot;&quot;&quot;</span><span class="s1"> 
</span><span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">absolute_import 
 
</span><span class="s2">import </span><span class="s1">logging 
</span><span class="s2">import </span><span class="s1">warnings 
 
 
</span><span class="s2">class </span><span class="s1">PipDeprecationWarning(Warning): 
    </span><span class="s2">pass</span><span class="s1"> 
 
 
</span><span class="s2">class </span><span class="s1">Pending(object): 
    </span><span class="s2">pass</span><span class="s1"> 
 
 
</span><span class="s2">class </span><span class="s1">RemovedInPip10Warning(PipDeprecationWarning): 
    </span><span class="s2">pass</span><span class="s1"> 
 
 
</span><span class="s2">class </span><span class="s1">RemovedInPip11Warning(PipDeprecationWarning</span><span class="s2">, </span><span class="s1">Pending): 
    </span><span class="s2">pass</span><span class="s1"> 
 
 
</span><span class="s2">class </span><span class="s1">Python26DeprecationWarning(PipDeprecationWarning): 
    </span><span class="s2">pass</span><span class="s1"> 
 
 
</span><span class="s3"># Warnings &lt;-&gt; Logging Integration</span><span class="s1"> 
 
 
_warnings_showwarning = </span><span class="s2">None</span><span class="s1"> 
 
 
</span><span class="s2">def </span><span class="s1">_showwarning(message</span><span class="s2">, </span><span class="s1">category</span><span class="s2">, </span><span class="s1">filename</span><span class="s2">, </span><span class="s1">lineno</span><span class="s2">, </span><span class="s1">file=</span><span class="s2">None, </span><span class="s1">line=</span><span class="s2">None</span><span class="s1">): 
    </span><span class="s2">if </span><span class="s1">file </span><span class="s2">is not None</span><span class="s1">: 
        </span><span class="s2">if </span><span class="s1">_warnings_showwarning </span><span class="s2">is not None</span><span class="s1">: 
            _warnings_showwarning( 
                message</span><span class="s2">, </span><span class="s1">category</span><span class="s2">, </span><span class="s1">filename</span><span class="s2">, </span><span class="s1">lineno</span><span class="s2">, </span><span class="s1">file</span><span class="s2">, </span><span class="s1">line</span><span class="s2">,</span><span class="s1"> 
            ) 
    </span><span class="s2">else</span><span class="s1">: 
        </span><span class="s2">if </span><span class="s1">issubclass(category</span><span class="s2">, </span><span class="s1">PipDeprecationWarning): 
            </span><span class="s3"># We use a specially named logger which will handle all of the</span><span class="s1"> 
            </span><span class="s3"># deprecation messages for pip.</span><span class="s1"> 
            logger = logging.getLogger(</span><span class="s4">&quot;pip.deprecations&quot;</span><span class="s1">) 
 
            </span><span class="s3"># This is purposely using the % formatter here instead of letting</span><span class="s1"> 
            </span><span class="s3"># the logging module handle the interpolation. This is because we</span><span class="s1"> 
            </span><span class="s3"># want it to appear as if someone typed this entire message out.</span><span class="s1"> 
            log_message = </span><span class="s4">&quot;DEPRECATION: %s&quot; </span><span class="s1">% message 
 
            </span><span class="s3"># PipDeprecationWarnings that are Pending still have at least 2</span><span class="s1"> 
            </span><span class="s3"># versions to go until they are removed so they can just be</span><span class="s1"> 
            </span><span class="s3"># warnings.  Otherwise, they will be removed in the very next</span><span class="s1"> 
            </span><span class="s3"># version of pip. We want these to be more obvious so we use the</span><span class="s1"> 
            </span><span class="s3"># ERROR logging level.</span><span class="s1"> 
            </span><span class="s2">if </span><span class="s1">issubclass(category</span><span class="s2">, </span><span class="s1">Pending): 
                logger.warning(log_message) 
            </span><span class="s2">else</span><span class="s1">: 
                logger.error(log_message) 
        </span><span class="s2">else</span><span class="s1">: 
            _warnings_showwarning( 
                message</span><span class="s2">, </span><span class="s1">category</span><span class="s2">, </span><span class="s1">filename</span><span class="s2">, </span><span class="s1">lineno</span><span class="s2">, </span><span class="s1">file</span><span class="s2">, </span><span class="s1">line</span><span class="s2">,</span><span class="s1"> 
            ) 
 
 
</span><span class="s2">def </span><span class="s1">install_warning_logger(): 
    </span><span class="s3"># Enable our Deprecation Warnings</span><span class="s1"> 
    warnings.simplefilter(</span><span class="s4">&quot;default&quot;</span><span class="s2">, </span><span class="s1">PipDeprecationWarning</span><span class="s2">, </span><span class="s1">append=</span><span class="s2">True</span><span class="s1">) 
 
    </span><span class="s2">global </span><span class="s1">_warnings_showwarning 
 
    </span><span class="s2">if </span><span class="s1">_warnings_showwarning </span><span class="s2">is None</span><span class="s1">: 
        _warnings_showwarning = warnings.showwarning 
        warnings.showwarning = _showwarning 
</span></pre>
</body>
</html>